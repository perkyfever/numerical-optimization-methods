#include <algorithm>
#include <iostream>
#include "analytical.h"
#include "constants.h"
#include "implicit.h"

double payoff(double si) {
    return std::max<double>(si - (double)K, 0);
}

int main() {
    std::array<double, N + 1> c_init = {};
    for (int i = 0; i <= N; ++i) {
        c_init[i] = payoff((double)i * S_max / (double)N);
    }

    std::array<double, M + 1> tau = {};
    for (int i = 0; i <= M; ++i) {
        tau[i] = i / (double)M;
    }

    std::array<double, N + 1> c_res = {};
    go_implicit<N + 1, M + 1>(c_init, tau, c_res);

    size_t ind = std::min((size_t)(N * K * 0.9 / S_max), N);
    size_t ind_next = std::min((size_t)(ind + 1), N);
    double c_max = c_res[ind] + (c_res[ind_next] - c_res[ind]) * 0.5;

    std::cout << "Analytic: C(S_max, T) = " << option_price(K * 0.9, 1) << '\n';
    std::cout << "Numerical: C(S_max, T) = " << c_max << '\n';

    for (int i = 0; i <= N; i++) {
        std::cout << "C(" << (double)i * S_max / (double)N << ", T) = " << c_res[i];
        std::cout << std::endl;
    }

    return 0;
}

// Analytic: C(S_max, T) = 10.9207
// Numerical: C(S_max, T) = 10.895
// C(0, T) = 0
// C(0.306485, T) = 0.000104423
// C(0.612971, T) = 0.000206615
// C(0.919456, T) = 0.000374374
// C(1.22594, T) = 0.000609255
// C(1.53243, T) = 0.000916765
// C(1.83891, T) = 0.00130242
// C(2.1454, T) = 0.00177143
// C(2.45188, T) = 0.00232867
// C(2.75837, T) = 0.00297874
// C(3.06485, T) = 0.00372601
// C(3.37134, T) = 0.00457461
// C(3.67783, T) = 0.00552848
// C(3.98431, T) = 0.00659142
// C(4.2908, T) = 0.00776707
// C(4.59728, T) = 0.00905892
// C(4.90377, T) = 0.0104704
// C(5.21025, T) = 0.0120047
// C(5.51674, T) = 0.013665
// C(5.82322, T) = 0.0154545
// C(6.12971, T) = 0.017376
// C(6.43619, T) = 0.0194327
// C(6.74268, T) = 0.0216272
// C(7.04916, T) = 0.0239623
// C(7.35565, T) = 0.0264409
// C(7.66214, T) = 0.0290655
// C(7.96862, T) = 0.0318387
// C(8.27511, T) = 0.0347632
// C(8.58159, T) = 0.0378413
// C(8.88808, T) = 0.0410756
// C(9.19456, T) = 0.0444684
// C(9.50105, T) = 0.0480221
// C(9.80753, T) = 0.0517391
// C(10.114, T) = 0.0556216
// C(10.4205, T) = 0.0596718
// C(10.727, T) = 0.0638921
// C(11.0335, T) = 0.0682845
// C(11.34, T) = 0.0728513
// C(11.6464, T) = 0.0775945
// C(11.9529, T) = 0.0825162
// C(12.2594, T) = 0.0876185
// C(12.5659, T) = 0.0929034
// C(12.8724, T) = 0.0983729
// C(13.1789, T) = 0.104029
// C(13.4854, T) = 0.109874
// C(13.7918, T) = 0.115909
// C(14.0983, T) = 0.122137
// C(14.4048, T) = 0.128558
// C(14.7113, T) = 0.135176
// C(15.0178, T) = 0.141993
// C(15.3243, T) = 0.149008
// C(15.6308, T) = 0.156226
// C(15.9372, T) = 0.163647
// C(16.2437, T) = 0.171273
// C(16.5502, T) = 0.179106
// C(16.8567, T) = 0.187148
// C(17.1632, T) = 0.1954
// C(17.4697, T) = 0.203864
// C(17.7762, T) = 0.212542
// C(18.0826, T) = 0.221436
// C(18.3891, T) = 0.230546
// C(18.6956, T) = 0.239875
// C(19.0021, T) = 0.249425
// C(19.3086, T) = 0.259197
// C(19.6151, T) = 0.269192
// C(19.9216, T) = 0.279412
// C(20.228, T) = 0.289859
// C(20.5345, T) = 0.300534
// C(20.841, T) = 0.31144
// C(21.1475, T) = 0.322576
// C(21.454, T) = 0.333946
// C(21.7605, T) = 0.345549
// C(22.067, T) = 0.357389
// C(22.3734, T) = 0.369466
// C(22.6799, T) = 0.381782
// C(22.9864, T) = 0.394338
// C(23.2929, T) = 0.407136
// C(23.5994, T) = 0.420177
// C(23.9059, T) = 0.433463
// C(24.2123, T) = 0.446995
// C(24.5188, T) = 0.460775
// C(24.8253, T) = 0.474803
// C(25.1318, T) = 0.489082
// C(25.4383, T) = 0.503612
// C(25.7448, T) = 0.518395
// C(26.0513, T) = 0.533433
// C(26.3577, T) = 0.548727
// C(26.6642, T) = 0.564277
// C(26.9707, T) = 0.580087
// C(27.2772, T) = 0.596156
// C(27.5837, T) = 0.612486
// C(27.8902, T) = 0.629079
// C(28.1967, T) = 0.645935
// C(28.5031, T) = 0.663057
// C(28.8096, T) = 0.680444
// C(29.1161, T) = 0.6981
// C(29.4226, T) = 0.716025
// C(29.7291, T) = 0.734219
// C(30.0356, T) = 0.752686
// C(30.3421, T) = 0.771425
// C(30.6485, T) = 0.790438
// C(30.955, T) = 0.809726
// C(31.2615, T) = 0.829291
// C(31.568, T) = 0.849133
// C(31.8745, T) = 0.869255
// C(32.181, T) = 0.889657
// C(32.4875, T) = 0.91034
// C(32.7939, T) = 0.931305
// C(33.1004, T) = 0.952555
// C(33.4069, T) = 0.974089
// C(33.7134, T) = 0.99591
// C(34.0199, T) = 1.01802
// C(34.3264, T) = 1.04041
// C(34.6329, T) = 1.0631
// C(34.9393, T) = 1.08608
// C(35.2458, T) = 1.10935
// C(35.5523, T) = 1.13291
// C(35.8588, T) = 1.15677
// C(36.1653, T) = 1.18092
// C(36.4718, T) = 1.20537
// C(36.7783, T) = 1.23012
// C(37.0847, T) = 1.25516
// C(37.3912, T) = 1.28051
// C(37.6977, T) = 1.30615
// C(38.0042, T) = 1.3321
// C(38.3107, T) = 1.35836
// C(38.6172, T) = 1.38491
// C(38.9236, T) = 1.41178
// C(39.2301, T) = 1.43895
// C(39.5366, T) = 1.46642
// C(39.8431, T) = 1.49421
// C(40.1496, T) = 1.52231
// C(40.4561, T) = 1.55071
// C(40.7626, T) = 1.57943
// C(41.069, T) = 1.60847
// C(41.3755, T) = 1.63781
// C(41.682, T) = 1.66748
// C(41.9885, T) = 1.69746
// C(42.295, T) = 1.72775
// C(42.6015, T) = 1.75837
// C(42.908, T) = 1.7893
// C(43.2144, T) = 1.82055
// C(43.5209, T) = 1.85213
// C(43.8274, T) = 1.88403
// C(44.1339, T) = 1.91625
// C(44.4404, T) = 1.9488
// C(44.7469, T) = 1.98167
// C(45.0534, T) = 2.01487
// C(45.3598, T) = 2.0484
// C(45.6663, T) = 2.08226
// C(45.9728, T) = 2.11644
// C(46.2793, T) = 2.15096
// C(46.5858, T) = 2.18581
// C(46.8923, T) = 2.22099
// C(47.1988, T) = 2.25651
// C(47.5052, T) = 2.29236
// C(47.8117, T) = 2.32854
// C(48.1182, T) = 2.36506
// C(48.4247, T) = 2.40192
// C(48.7312, T) = 2.43912
// C(49.0377, T) = 2.47666
// C(49.3442, T) = 2.51454
// C(49.6506, T) = 2.55276
// C(49.9571, T) = 2.59132
// C(50.2636, T) = 2.63023
// C(50.5701, T) = 2.66948
// C(50.8766, T) = 2.70908
// C(51.1831, T) = 2.74902
// C(51.4896, T) = 2.78931
// C(51.796, T) = 2.82995
// C(52.1025, T) = 2.87094
// C(52.409, T) = 2.91228
// C(52.7155, T) = 2.95397
// C(53.022, T) = 2.99601
// C(53.3285, T) = 3.0384
// C(53.6349, T) = 3.08115
// C(53.9414, T) = 3.12425
// C(54.2479, T) = 3.16771
// C(54.5544, T) = 3.21152
// C(54.8609, T) = 3.2557
// C(55.1674, T) = 3.30023
// C(55.4739, T) = 3.34512
// C(55.7803, T) = 3.39037
// C(56.0868, T) = 3.43598
// C(56.3933, T) = 3.48195
// C(56.6998, T) = 3.52829
// C(57.0063, T) = 3.57499
// C(57.3128, T) = 3.62206
// C(57.6193, T) = 3.66949
// C(57.9257, T) = 3.71728
// C(58.2322, T) = 3.76545
// C(58.5387, T) = 3.81398
// C(58.8452, T) = 3.86288
// C(59.1517, T) = 3.91216
// C(59.4582, T) = 3.9618
// C(59.7647, T) = 4.01181
// C(60.0711, T) = 4.0622
// C(60.3776, T) = 4.11296
// C(60.6841, T) = 4.1641
// C(60.9906, T) = 4.21561
// C(61.2971, T) = 4.2675
// C(61.6036, T) = 4.31976
// C(61.9101, T) = 4.3724
// C(62.2165, T) = 4.42543
// C(62.523, T) = 4.47883
// C(62.8295, T) = 4.53261
// C(63.136, T) = 4.58677
// C(63.4425, T) = 4.64131
// C(63.749, T) = 4.69624
// C(64.0555, T) = 4.75155
// C(64.3619, T) = 4.80725
// C(64.6684, T) = 4.86333
// C(64.9749, T) = 4.9198
// C(65.2814, T) = 4.97665
// C(65.5879, T) = 5.03389
// C(65.8944, T) = 5.09152
// C(66.2009, T) = 5.14954
// C(66.5073, T) = 5.20796
// C(66.8138, T) = 5.26676
// C(67.1203, T) = 5.32595
// C(67.4268, T) = 5.38554
// C(67.7333, T) = 5.44552
// C(68.0398, T) = 5.5059
// C(68.3462, T) = 5.56667
// C(68.6527, T) = 5.62784
// C(68.9592, T) = 5.6894
// C(69.2657, T) = 5.75136
// C(69.5722, T) = 5.81372
// C(69.8787, T) = 5.87649
// C(70.1852, T) = 5.93965
// C(70.4916, T) = 6.00321
// C(70.7981, T) = 6.06717
// C(71.1046, T) = 6.13154
// C(71.4111, T) = 6.1963
// C(71.7176, T) = 6.26148
// C(72.0241, T) = 6.32706
// C(72.3306, T) = 6.39304
// C(72.637, T) = 6.45943
// C(72.9435, T) = 6.52623
// C(73.25, T) = 6.59343
// C(73.5565, T) = 6.66105
// C(73.863, T) = 6.72907
// C(74.1695, T) = 6.79751
// C(74.476, T) = 6.86636
// C(74.7824, T) = 6.93561
// C(75.0889, T) = 7.00528
// C(75.3954, T) = 7.07537
// C(75.7019, T) = 7.14587
// C(76.0084, T) = 7.21678
// C(76.3149, T) = 7.28811
// C(76.6214, T) = 7.35986
// C(76.9278, T) = 7.43202
// C(77.2343, T) = 7.5046
// C(77.5408, T) = 7.5776
// C(77.8473, T) = 7.65102
// C(78.1538, T) = 7.72486
// C(78.4603, T) = 7.79912
// C(78.7668, T) = 7.87381
// C(79.0732, T) = 7.94891
// C(79.3797, T) = 8.02444
// C(79.6862, T) = 8.1004
// C(79.9927, T) = 8.17678
// C(80.2992, T) = 8.25358
// C(80.6057, T) = 8.33081
// C(80.9122, T) = 8.40847
// C(81.2186, T) = 8.48655
// C(81.5251, T) = 8.56507
// C(81.8316, T) = 8.64401
// C(82.1381, T) = 8.72338
// C(82.4446, T) = 8.80319
// C(82.7511, T) = 8.88342
// C(83.0575, T) = 8.96409
// C(83.364, T) = 9.04519
// C(83.6705, T) = 9.12673
// C(83.977, T) = 9.2087
// C(84.2835, T) = 9.2911
// C(84.59, T) = 9.37394
// C(84.8965, T) = 9.45722
// C(85.2029, T) = 9.54093
// C(85.5094, T) = 9.62509
// C(85.8159, T) = 9.70968
// C(86.1224, T) = 9.79471
// C(86.4289, T) = 9.88018
// C(86.7354, T) = 9.96609
// C(87.0419, T) = 10.0524
// C(87.3483, T) = 10.1392
// C(87.6548, T) = 10.2265
// C(87.9613, T) = 10.3142
// C(88.2678, T) = 10.4023
// C(88.5743, T) = 10.4909
// C(88.8808, T) = 10.5799
// C(89.1873, T) = 10.6693
// C(89.4937, T) = 10.7593
// C(89.8002, T) = 10.8496
// C(90.1067, T) = 10.9404
// C(90.4132, T) = 11.0317
// C(90.7197, T) = 11.1234
// C(91.0262, T) = 11.2155
// C(91.3327, T) = 11.3082
// C(91.6391, T) = 11.4012
// C(91.9456, T) = 11.4947
// C(92.2521, T) = 11.5887
// C(92.5586, T) = 11.6831
// C(92.8651, T) = 11.778
// C(93.1716, T) = 11.8733
// C(93.4781, T) = 11.9691
// C(93.7845, T) = 12.0654
// C(94.091, T) = 12.1621
// C(94.3975, T) = 12.2592
// C(94.704, T) = 12.3569
// C(95.0105, T) = 12.4549
// C(95.317, T) = 12.5535
// C(95.6235, T) = 12.6525
// C(95.9299, T) = 12.752
// C(96.2364, T) = 12.8519
// C(96.5429, T) = 12.9523
// C(96.8494, T) = 13.0531
// C(97.1559, T) = 13.1544
// C(97.4624, T) = 13.2562
// C(97.7688, T) = 13.3585
// C(98.0753, T) = 13.4612
// C(98.3818, T) = 13.5644
// C(98.6883, T) = 13.668
// C(98.9948, T) = 13.7721
// C(99.3013, T) = 13.8767
// C(99.6078, T) = 13.9818
// C(99.9142, T) = 14.0873
// C(100.221, T) = 14.1933
// C(100.527, T) = 14.2998
// C(100.834, T) = 14.4067
// C(101.14, T) = 14.5141
// C(101.447, T) = 14.622
// C(101.753, T) = 14.7304
// C(102.06, T) = 14.8392
// C(102.366, T) = 14.9486
// C(102.673, T) = 15.0584
// C(102.979, T) = 15.1686
// C(103.286, T) = 15.2794
// C(103.592, T) = 15.3906
// C(103.899, T) = 15.5023
// C(104.205, T) = 15.6145
// C(104.512, T) = 15.7271
// C(104.818, T) = 15.8403
// C(105.124, T) = 15.9539
// C(105.431, T) = 16.068
// C(105.737, T) = 16.1826
// C(106.044, T) = 16.2977
// C(106.35, T) = 16.4132
// C(106.657, T) = 16.5293
// C(106.963, T) = 16.6458
// C(107.27, T) = 16.7628
// C(107.576, T) = 16.8803
// C(107.883, T) = 16.9983
// C(108.189, T) = 17.1168
// C(108.496, T) = 17.2358
// C(108.802, T) = 17.3552
// C(109.109, T) = 17.4752
// C(109.415, T) = 17.5956
// C(109.722, T) = 17.7165
// C(110.028, T) = 17.8379
// C(110.335, T) = 17.9598
// C(110.641, T) = 18.0822
// C(110.948, T) = 18.2051
// C(111.254, T) = 18.3285
// C(111.561, T) = 18.4524
// C(111.867, T) = 18.5768
// C(112.174, T) = 18.7017
// C(112.48, T) = 18.827
// C(112.787, T) = 18.9529
// C(113.093, T) = 19.0793
// C(113.4, T) = 19.2061
// C(113.706, T) = 19.3335
// C(114.013, T) = 19.4614
// C(114.319, T) = 19.5897
// C(114.626, T) = 19.7186
// C(114.932, T) = 19.848
// C(115.239, T) = 19.9778
// C(115.545, T) = 20.1082
// C(115.851, T) = 20.2391
// C(116.158, T) = 20.3705
// C(116.464, T) = 20.5023
// C(116.771, T) = 20.6347
// C(117.077, T) = 20.7676
// C(117.384, T) = 20.901
// C(117.69, T) = 21.0349
// C(117.997, T) = 21.1694
// C(118.303, T) = 21.3043
// C(118.61, T) = 21.4397
// C(118.916, T) = 21.5757
// C(119.223, T) = 21.7121
// C(119.529, T) = 21.8491
// C(119.836, T) = 21.9866
// C(120.142, T) = 22.1245
// C(120.449, T) = 22.263
// C(120.755, T) = 22.4021
// C(121.062, T) = 22.5416
// C(121.368, T) = 22.6816
// C(121.675, T) = 22.8222
// C(121.981, T) = 22.9633
// C(122.288, T) = 23.1048
// C(122.594, T) = 23.2469
// C(122.901, T) = 23.3896
// C(123.207, T) = 23.5327
// C(123.514, T) = 23.6764
// C(123.82, T) = 23.8205
// C(124.127, T) = 23.9652
// C(124.433, T) = 24.1105
// C(124.74, T) = 24.2562
// C(125.046, T) = 24.4024
// C(125.353, T) = 24.5492
// C(125.659, T) = 24.6965
// C(125.966, T) = 24.8444
// C(126.272, T) = 24.9927
// C(126.578, T) = 25.1416
// C(126.885, T) = 25.291
// C(127.191, T) = 25.4409
// C(127.498, T) = 25.5913
// C(127.804, T) = 25.7423
// C(128.111, T) = 25.8938
// C(128.417, T) = 26.0459
// C(128.724, T) = 26.1984
// C(129.03, T) = 26.3515
// C(129.337, T) = 26.5051
// C(129.643, T) = 26.6593
// C(129.95, T) = 26.814
// C(130.256, T) = 26.9692
// C(130.563, T) = 27.1249
// C(130.869, T) = 27.2812
// C(131.176, T) = 27.438
// C(131.482, T) = 27.5953
// C(131.789, T) = 27.7532
// C(132.095, T) = 27.9116
// C(132.402, T) = 28.0706
// C(132.708, T) = 28.23
// C(133.015, T) = 28.39
// C(133.321, T) = 28.5506
// C(133.628, T) = 28.7117
// C(133.934, T) = 28.8733
// C(134.241, T) = 29.0355
// C(134.547, T) = 29.1982
// C(134.854, T) = 29.3614
// C(135.16, T) = 29.5252
// C(135.467, T) = 29.6896
// C(135.773, T) = 29.8544
// C(136.08, T) = 30.0198
// C(136.386, T) = 30.1858
// C(136.692, T) = 30.3523
// C(136.999, T) = 30.5193
// C(137.305, T) = 30.6869
// C(137.612, T) = 30.855
// C(137.918, T) = 31.0237
// C(138.225, T) = 31.1929
// C(138.531, T) = 31.3627
// C(138.838, T) = 31.533
// C(139.144, T) = 31.7039
// C(139.451, T) = 31.8753
// C(139.757, T) = 32.0472
// C(140.064, T) = 32.2197
// C(140.37, T) = 32.3928
// C(140.677, T) = 32.5664
// C(140.983, T) = 32.7405
// C(141.29, T) = 32.9153
// C(141.596, T) = 33.0905
// C(141.903, T) = 33.2663
// C(142.209, T) = 33.4427
// C(142.516, T) = 33.6196
// C(142.822, T) = 33.7971
// C(143.129, T) = 33.9751
// C(143.435, T) = 34.1537
// C(143.742, T) = 34.3328
// C(144.048, T) = 34.5125
// C(144.355, T) = 34.6928
// C(144.661, T) = 34.8736
// C(144.968, T) = 35.055
// C(145.274, T) = 35.2369
// C(145.581, T) = 35.4194
// C(145.887, T) = 35.6024
// C(146.194, T) = 35.786
// C(146.5, T) = 35.9702
// C(146.807, T) = 36.1549
// C(147.113, T) = 36.3402
// C(147.419, T) = 36.526
// C(147.726, T) = 36.7124
// C(148.032, T) = 36.8994
// C(148.339, T) = 37.087
// C(148.645, T) = 37.2751
// C(148.952, T) = 37.4637
// C(149.258, T) = 37.653
// C(149.565, T) = 37.8428
// C(149.871, T) = 38.0331
// C(150.178, T) = 38.2241
// C(150.484, T) = 38.4156
// C(150.791, T) = 38.6076
// C(151.097, T) = 38.8003
// C(151.404, T) = 38.9935
// C(151.71, T) = 39.1872
// C(152.017, T) = 39.3816
// C(152.323, T) = 39.5765
// C(152.63, T) = 39.772
// C(152.936, T) = 39.9681
// C(153.243, T) = 40.1647
// C(153.549, T) = 40.3619
// C(153.856, T) = 40.5597
// C(154.162, T) = 40.758
// C(154.469, T) = 40.9569
// C(154.775, T) = 41.1564
// C(155.082, T) = 41.3565
// C(155.388, T) = 41.5572
// C(155.695, T) = 41.7584
// C(156.001, T) = 41.9602
// C(156.308, T) = 42.1626
// C(156.614, T) = 42.3655
// C(156.921, T) = 42.5691
// C(157.227, T) = 42.7732
// C(157.534, T) = 42.9779
// C(157.84, T) = 43.1832
// C(158.146, T) = 43.389
// C(158.453, T) = 43.5955
// C(158.759, T) = 43.8025
// C(159.066, T) = 44.0101
// C(159.372, T) = 44.2183
// C(159.679, T) = 44.427
// C(159.985, T) = 44.6364
// C(160.292, T) = 44.8463
// C(160.598, T) = 45.0569
// C(160.905, T) = 45.268
// C(161.211, T) = 45.4797
// C(161.518, T) = 45.6919
// C(161.824, T) = 45.9048
// C(162.131, T) = 46.1183
// C(162.437, T) = 46.3323
// C(162.744, T) = 46.5469
// C(163.05, T) = 46.7621
// C(163.357, T) = 46.9779
// C(163.663, T) = 47.1943
// C(163.97, T) = 47.4113
// C(164.276, T) = 47.6289
// C(164.583, T) = 47.8471
// C(164.889, T) = 48.0658
// C(165.196, T) = 48.2852
// C(165.502, T) = 48.5051
// C(165.809, T) = 48.7257
// C(166.115, T) = 48.9468
// C(166.422, T) = 49.1685
// C(166.728, T) = 49.3908
// C(167.035, T) = 49.6138
// C(167.341, T) = 49.8373
// C(167.648, T) = 50.0614
// C(167.954, T) = 50.2861
// C(168.26, T) = 50.5114
// C(168.567, T) = 50.7373
// C(168.873, T) = 50.9638
// C(169.18, T) = 51.1909
// C(169.486, T) = 51.4186
// C(169.793, T) = 51.6469
// C(170.099, T) = 51.8758
// C(170.406, T) = 52.1053
// C(170.712, T) = 52.3354
// C(171.019, T) = 52.5661
// C(171.325, T) = 52.7974
// C(171.632, T) = 53.0293
// C(171.938, T) = 53.2618
// C(172.245, T) = 53.4949
// C(172.551, T) = 53.7286
// C(172.858, T) = 53.9629
// C(173.164, T) = 54.1979
// C(173.471, T) = 54.4334
// C(173.777, T) = 54.6695
// C(174.084, T) = 54.9063
// C(174.39, T) = 55.1436
// C(174.697, T) = 55.3816
// C(175.003, T) = 55.6201
// C(175.31, T) = 55.8593
// C(175.616, T) = 56.0991
// C(175.923, T) = 56.3395
// C(176.229, T) = 56.5805
// C(176.536, T) = 56.8221
// C(176.842, T) = 57.0644
// C(177.149, T) = 57.3072
// C(177.455, T) = 57.5506
// C(177.762, T) = 57.7947
// C(178.068, T) = 58.0394
// C(178.375, T) = 58.2847
// C(178.681, T) = 58.5306
// C(178.987, T) = 58.7771
// C(179.294, T) = 59.0242
// C(179.6, T) = 59.272
// C(179.907, T) = 59.5203
// C(180.213, T) = 59.7693
// C(180.52, T) = 60.0189
// C(180.826, T) = 60.2691
// C(181.133, T) = 60.52
// C(181.439, T) = 60.7714
// C(181.746, T) = 61.0235
// C(182.052, T) = 61.2762
// C(182.359, T) = 61.5295
// C(182.665, T) = 61.7834
// C(182.972, T) = 62.038
// C(183.278, T) = 62.2931
// C(183.585, T) = 62.5489
// C(183.891, T) = 62.8053
// C(184.198, T) = 63.0624
// C(184.504, T) = 63.32
// C(184.811, T) = 63.5783
// C(185.117, T) = 63.8372
// C(185.424, T) = 64.0968
// C(185.73, T) = 64.3569
// C(186.037, T) = 64.6177
// C(186.343, T) = 64.8791
// C(186.65, T) = 65.1411
// C(186.956, T) = 65.4038
// C(187.263, T) = 65.6671
// C(187.569, T) = 65.931
// C(187.876, T) = 66.1955
// C(188.182, T) = 66.4607
// C(188.489, T) = 66.7265
// C(188.795, T) = 66.993
// C(189.102, T) = 67.26
// C(189.408, T) = 67.5277
// C(189.714, T) = 67.796
// C(190.021, T) = 68.065
// C(190.327, T) = 68.3346
// C(190.634, T) = 68.6048
// C(190.94, T) = 68.8756
// C(191.247, T) = 69.1471
// C(191.553, T) = 69.4193
// C(191.86, T) = 69.692
// C(192.166, T) = 69.9654
// C(192.473, T) = 70.2394
// C(192.779, T) = 70.5141
// C(193.086, T) = 70.7894
// C(193.392, T) = 71.0653
// C(193.699, T) = 71.3419
// C(194.005, T) = 71.6191
// C(194.312, T) = 71.8969
// C(194.618, T) = 72.1754
// C(194.925, T) = 72.4545
// C(195.231, T) = 72.7343
// C(195.538, T) = 73.0147
// C(195.844, T) = 73.2957
// C(196.151, T) = 73.5774
// C(196.457, T) = 73.8598
// C(196.764, T) = 74.1427
// C(197.07, T) = 74.4263
// C(197.377, T) = 74.7106
// C(197.683, T) = 74.9955
// C(197.99, T) = 75.281
// C(198.296, T) = 75.5672
// C(198.603, T) = 75.854
// C(198.909, T) = 76.1415
// C(199.216, T) = 76.4296
// C(199.522, T) = 76.7184
// C(199.828, T) = 77.0078
// C(200.135, T) = 77.2978
// C(200.441, T) = 77.5885
// C(200.748, T) = 77.8799
// C(201.054, T) = 78.1719
// C(201.361, T) = 78.4645
// C(201.667, T) = 78.7578
// C(201.974, T) = 79.0518
// C(202.28, T) = 79.3464
// C(202.587, T) = 79.6416
// C(202.893, T) = 79.9375
// C(203.2, T) = 80.2341
// C(203.506, T) = 80.5312
// C(203.813, T) = 80.8291
// C(204.119, T) = 81.1276
// C(204.426, T) = 81.4268
// C(204.732, T) = 81.7266
// C(205.039, T) = 82.027
// C(205.345, T) = 82.3282
// C(205.652, T) = 82.6299
// C(205.958, T) = 82.9324
// C(206.265, T) = 83.2354
// C(206.571, T) = 83.5392
// C(206.878, T) = 83.8436
// C(207.184, T) = 84.1486
// C(207.491, T) = 84.4543
// C(207.797, T) = 84.7607
// C(208.104, T) = 85.0677
// C(208.41, T) = 85.3754
// C(208.717, T) = 85.6838
// C(209.023, T) = 85.9928
// C(209.33, T) = 86.3024
// C(209.636, T) = 86.6128
// C(209.943, T) = 86.9238
// C(210.249, T) = 87.2354
// C(210.555, T) = 87.5477
// C(210.862, T) = 87.8607
// C(211.168, T) = 88.1743
// C(211.475, T) = 88.4886
// C(211.781, T) = 88.8036
// C(212.088, T) = 89.1192
// C(212.394, T) = 89.4355
// C(212.701, T) = 89.7525
// C(213.007, T) = 90.0701
// C(213.314, T) = 90.3884
// C(213.62, T) = 90.7073
// C(213.927, T) = 91.0269
// C(214.233, T) = 91.3472
// C(214.54, T) = 91.6682
// C(214.846, T) = 91.9898
// C(215.153, T) = 92.3121
// C(215.459, T) = 92.6351
// C(215.766, T) = 92.9587
// C(216.072, T) = 93.283
// C(216.379, T) = 93.608
// C(216.685, T) = 93.9336
// C(216.992, T) = 94.2599
// C(217.298, T) = 94.5869
// C(217.605, T) = 94.9146
// C(217.911, T) = 95.2429
// C(218.218, T) = 95.5719
// C(218.524, T) = 95.9016
// C(218.831, T) = 96.2319
// C(219.137, T) = 96.5629
// C(219.444, T) = 96.8946
// C(219.75, T) = 97.227
// C(220.057, T) = 97.5601
// C(220.363, T) = 97.8938
// C(220.67, T) = 98.2282
// C(220.976, T) = 98.5633
// C(221.282, T) = 98.899
// C(221.589, T) = 99.2354
// C(221.895, T) = 99.5725
// C(222.202, T) = 99.9103
// C(222.508, T) = 100.249
// C(222.815, T) = 100.588
// C(223.121, T) = 100.928
// C(223.428, T) = 101.268
// C(223.734, T) = 101.609
// C(224.041, T) = 101.951
// C(224.347, T) = 102.294
// C(224.654, T) = 102.637
// C(224.96, T) = 102.981
// C(225.267, T) = 103.326
// C(225.573, T) = 103.671
// C(225.88, T) = 104.017
// C(226.186, T) = 104.364
// C(226.493, T) = 104.711
// C(226.799, T) = 105.059
// C(227.106, T) = 105.408
// C(227.412, T) = 105.757
// C(227.719, T) = 106.107
// C(228.025, T) = 106.458
// C(228.332, T) = 106.809
// C(228.638, T) = 107.161
// C(228.945, T) = 107.514
// C(229.251, T) = 107.868
// C(229.558, T) = 108.222
// C(229.864, T) = 108.577
// C(230.171, T) = 108.932
// C(230.477, T) = 109.289
// C(230.784, T) = 109.646
// C(231.09, T) = 110.003
// C(231.396, T) = 110.362
// C(231.703, T) = 110.721
// C(232.009, T) = 111.08
// C(232.316, T) = 111.441
// C(232.622, T) = 111.802
// C(232.929, T) = 112.164
// C(233.235, T) = 112.526
// C(233.542, T) = 112.889
// C(233.848, T) = 113.253
// C(234.155, T) = 113.618
// C(234.461, T) = 113.983
// C(234.768, T) = 114.349
// C(235.074, T) = 114.716
// C(235.381, T) = 115.083
// C(235.687, T) = 115.451
// C(235.994, T) = 115.82
// C(236.3, T) = 116.189
// C(236.607, T) = 116.56
// C(236.913, T) = 116.93
// C(237.22, T) = 117.302
// C(237.526, T) = 117.674
// C(237.833, T) = 118.047
// C(238.139, T) = 118.421
// C(238.446, T) = 118.795
// C(238.752, T) = 119.17
// C(239.059, T) = 119.546
// C(239.365, T) = 119.922
// C(239.672, T) = 120.3
// C(239.978, T) = 120.677
// C(240.285, T) = 121.056
// C(240.591, T) = 121.435
// C(240.898, T) = 121.815
// C(241.204, T) = 122.196
// C(241.511, T) = 122.577
// C(241.817, T) = 122.959
// C(242.123, T) = 123.342
// C(242.43, T) = 123.726
// C(242.736, T) = 124.11
// C(243.043, T) = 124.495
// C(243.349, T) = 124.88
// C(243.656, T) = 125.267
// C(243.962, T) = 125.654
// C(244.269, T) = 126.042
// C(244.575, T) = 126.43
// C(244.882, T) = 126.819
// C(245.188, T) = 127.209
// C(245.495, T) = 127.6
// C(245.801, T) = 127.991
// C(246.108, T) = 128.383
// C(246.414, T) = 128.776
// C(246.721, T) = 129.169
// C(247.027, T) = 129.563
// C(247.334, T) = 129.958
// C(247.64, T) = 130.354
// C(247.947, T) = 130.75
// C(248.253, T) = 131.147
// C(248.56, T) = 131.545
// C(248.866, T) = 131.943
// C(249.173, T) = 132.342
// C(249.479, T) = 132.742
// C(249.786, T) = 133.143
// C(250.092, T) = 133.544
// C(250.399, T) = 133.946
// C(250.705, T) = 134.349
// C(251.012, T) = 134.752
// C(251.318, T) = 135.156
// C(251.625, T) = 135.561
// C(251.931, T) = 135.967
// C(252.238, T) = 136.373
// C(252.544, T) = 136.78
// C(252.85, T) = 137.188
// C(253.157, T) = 137.596
// C(253.463, T) = 138.005
// C(253.77, T) = 138.415
// C(254.076, T) = 138.826
// C(254.383, T) = 139.237
// C(254.689, T) = 139.649
// C(254.996, T) = 140.062
// C(255.302, T) = 140.476
// C(255.609, T) = 140.89
// C(255.915, T) = 141.305
// C(256.222, T) = 141.721
// C(256.528, T) = 142.137
// C(256.835, T) = 142.554
// C(257.141, T) = 142.972
// C(257.448, T) = 143.391
// C(257.754, T) = 143.81
// C(258.061, T) = 144.23
// C(258.367, T) = 144.651
// C(258.674, T) = 145.072
// C(258.98, T) = 145.494
// C(259.287, T) = 145.917
// C(259.593, T) = 146.341
// C(259.9, T) = 146.766
// C(260.206, T) = 147.191
// C(260.513, T) = 147.617
// C(260.819, T) = 148.043
// C(261.126, T) = 148.47
// C(261.432, T) = 148.899
// C(261.739, T) = 149.327
// C(262.045, T) = 149.757
// C(262.352, T) = 150.187
// C(262.658, T) = 150.618
// C(262.964, T) = 151.05
// C(263.271, T) = 151.482
// C(263.577, T) = 151.916
// C(263.884, T) = 152.349
// C(264.19, T) = 152.784
// C(264.497, T) = 153.22
// C(264.803, T) = 153.656
// C(265.11, T) = 154.093
// C(265.416, T) = 154.53
// C(265.723, T) = 154.968
// C(266.029, T) = 155.408
// C(266.336, T) = 155.847
// C(266.642, T) = 156.288
// C(266.949, T) = 156.729
// C(267.255, T) = 157.171
// C(267.562, T) = 157.614
// C(267.868, T) = 158.057
// C(268.175, T) = 158.502
// C(268.481, T) = 158.947
// C(268.788, T) = 159.392
// C(269.094, T) = 159.839
// C(269.401, T) = 160.286
// C(269.707, T) = 160.734
// C(270.014, T) = 161.183
// C(270.32, T) = 161.632
// C(270.627, T) = 162.082
// C(270.933, T) = 162.533
// C(271.24, T) = 162.985
// C(271.546, T) = 163.437
// C(271.853, T) = 163.891
// C(272.159, T) = 164.344
// C(272.466, T) = 164.799
// C(272.772, T) = 165.254
// C(273.079, T) = 165.711
// C(273.385, T) = 166.167
// C(273.691, T) = 166.625
// C(273.998, T) = 167.083
// C(274.304, T) = 167.543
// C(274.611, T) = 168.002
// C(274.917, T) = 168.463
// C(275.224, T) = 168.924
// C(275.53, T) = 169.387
// C(275.837, T) = 169.849
// C(276.143, T) = 170.313
// C(276.45, T) = 170.777
// C(276.756, T) = 171.242
// C(277.063, T) = 171.708
// C(277.369, T) = 172.175
// C(277.676, T) = 172.642
// C(277.982, T) = 173.11
// C(278.289, T) = 173.579
// C(278.595, T) = 174.049
// C(278.902, T) = 174.519
// C(279.208, T) = 174.99
// C(279.515, T) = 175.462
// C(279.821, T) = 175.935
// C(280.128, T) = 176.408
// C(280.434, T) = 176.882
// C(280.741, T) = 177.357
// C(281.047, T) = 177.833
// C(281.354, T) = 178.309
// C(281.66, T) = 178.787
// C(281.967, T) = 179.264
// C(282.273, T) = 179.743
// C(282.58, T) = 180.223
// C(282.886, T) = 180.703
// C(283.193, T) = 181.184
// C(283.499, T) = 181.665
// C(283.805, T) = 182.148
// C(284.112, T) = 182.631
// C(284.418, T) = 183.115
// C(284.725, T) = 183.6
// C(285.031, T) = 184.085
// C(285.338, T) = 184.572
// C(285.644, T) = 185.059
// C(285.951, T) = 185.547
// C(286.257, T) = 186.035
// C(286.564, T) = 186.524
// C(286.87, T) = 187.014
// C(287.177, T) = 187.505
// C(287.483, T) = 187.997
// C(287.79, T) = 188.489
// C(288.096, T) = 188.982
// C(288.403, T) = 189.476
// C(288.709, T) = 189.971
// C(289.016, T) = 190.466
// C(289.322, T) = 190.963
// C(289.629, T) = 191.46
// C(289.935, T) = 191.957
// C(290.242, T) = 192.456
// C(290.548, T) = 192.955
// C(290.855, T) = 193.455
// C(291.161, T) = 193.956
// C(291.468, T) = 194.458
// C(291.774, T) = 194.96
// C(292.081, T) = 195.463
// C(292.387, T) = 195.967
// C(292.694, T) = 196.471
// C(293, T) = 196.977
// C(293.307, T) = 197.483
// C(293.613, T) = 197.99
// C(293.92, T) = 198.498
// C(294.226, T) = 199.006
// C(294.532, T) = 199.516
// C(294.839, T) = 200.026
// C(295.145, T) = 200.536
// C(295.452, T) = 201.048
// C(295.758, T) = 201.56
// C(296.065, T) = 202.073
// C(296.371, T) = 202.587
// C(296.678, T) = 203.102
// C(296.984, T) = 203.618
// C(297.291, T) = 204.134
// C(297.597, T) = 204.651
// C(297.904, T) = 205.169
// C(298.21, T) = 205.687
// C(298.517, T) = 206.206
// C(298.823, T) = 206.727
// C(299.13, T) = 207.247
// C(299.436, T) = 207.769
// C(299.743, T) = 208.292
// C(300.049, T) = 208.815
// C(300.356, T) = 209.339
// C(300.662, T) = 209.864
// C(300.969, T) = 210.389
// C(301.275, T) = 210.916
// C(301.582, T) = 211.443
// C(301.888, T) = 211.971
// C(302.195, T) = 212.499
// C(302.501, T) = 213.029
// C(302.808, T) = 213.559
// C(303.114, T) = 214.09
// C(303.421, T) = 214.622
// C(303.727, T) = 215.154
// C(304.034, T) = 215.688
// C(304.34, T) = 216.222
// C(304.647, T) = 216.757
// C(304.953, T) = 217.293
// C(305.259, T) = 217.829
// C(305.566, T) = 218.367
// C(305.872, T) = 218.905
// C(306.179, T) = 219.444
// C(306.485, T) = 219.983
